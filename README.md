Rewrite of TTScriptingLibrary in progress